version: "3.8"

services:
  ai-api:
    build: .
    container_name: telesales_ai_api
    restart: always
    # Pass variabel port ke command uvicorn agar aplikasi jalan di port tersebut
    command: uvicorn main:app --host 0.0.0.0 --port ${AI_PORT}
    ports:
      # Map port host ke port container yang sama
      - "${AI_PORT}:${AI_PORT}"
    env_file:
      - ./.env
    environment:
      # Pastikan aplikasi Python juga tahu dia berjalan di port mana (opsional, tergantung kode)
      - PORT=${AI_PORT}

  ai-worker:
    build: .
    container_name: telesales_ai_worker
    restart: always
    command: python scheduler.py
    env_file:
      - ./.env
